
# إعداد ميزة التحقق والتسجيل عبر Telegram مع Firebase

هذا الدليل يشرح كيفية إعداد وتشغيل ميزتي التحقق والتسجيل عبر Telegram لمشروع My account VIP باستخدام Firebase.

## المتطلبات

- حساب على Telegram
- وصول إلى واجهة Firebase Console
- حساب على GitHub (للنشر)

## خطوات الإعداد

### 1. إنشاء بوت Telegram

1. ابحث عن "@BotFather" في Telegram
2. استخدم الأمر `/newbot` لإنشاء بوت جديد
3. اتبع التعليمات لإعطاء البوت اسم واسم مستخدم (username)
4. ستحصل على **Token API**، احفظه للخطوات التالية

### 2. تكوين البوت للسماح بتسجيل الدخول

1. أرسل الأمر `/setdomain` إلى BotFather
2. اختر البوت الذي أنشأته
3. أدخل النطاق الذي سيستخدمه موقعك:
   - للاختبار المحلي: `localhost`
   - للنشر على GitHub Pages: `username.github.io` (استبدل username باسم مستخدم GitHub الخاص بك)

### 3. تحديث ملفات المشروع

1. استبدل الملفات التالية بالملفات المحدثة:
   - `register-script.js` → `register-script-updated.js`
   - `telegram-server.js` → `telegram-server-updated.js`

2. تأكد من وجود ملف `telegram-auth-callback.html` في المشروع

### 4. تكوين Firebase للمصادقة

1. اذهب إلى [Firebase Console](https://console.firebase.google.com/)
2. اختر مشروعك "my-account-vip"
3. من القائمة الجانبية، اذهب إلى قسم "Authentication"
4. اختر علامة التبويب "Sign-in method"
5. قم بتفعيل مزودي المصادقة الذين تريد استخدامهم:
   - البريد الإلكتروني/كلمة المرور (Email/Password)
   - Google (اختياري)
   - أي مزود آخر ترغب في استخدامه

### 5. إضافة النطاقات المسموح بها في Firebase

1. في قسم Authentication، اختر علامة التبويب "Settings"
2. تحت "Authorized domains"، أضف النطاقات التالية:
   - `localhost` (للاختبار المحلي)
   - `username.github.io` (للنشر على GitHub Pages، استبدل username باسم مستخدم GitHub الخاص بك)

## كيفية استخدام الميزات

### ميزة التسجيل بحساب Telegram:

#### للمستخدمين:

1. في صفحة التسجيل، انقر على زر "التسجيل بحساب Telegram"
2. ستفتح نافذة منبثقة تطلب منك تسجيل الدخول إلى حسابك على Telegram
3. قم بتسجيل الدخول والموافقة على مشاركة بياناتك مع الموقع
4. سيتم إغلاق النافذة المنبثقة تلقائيًا وسيتم تعبئة بعض حقول التسجيل تلقائيًا
5. أكمل البيانات المتبقية في نموذج التسجيل
6. انقر على زر "إنشاء حساب" لإكمال عملية التسجيل

### اختبار الميزة محليًا

1. قم بتشغيل خادم محلي (مثل Live Server في VS Code)
2. افتح صفحة التسجيل (`register.html`)
3. انقر على زر "التسجيل بحساب Telegram"
4. قم بتسجيل الدخول عبر Telegram في النافذة المنبثقة
5. تحقق من تعبئة بيانات النموذج تلقائيًا

### نشر المشروع على GitHub Pages

1. أنشئ مستودعًا جديدًا على GitHub
2. ارفع جميع ملفات المشروع إلى هذا المستودع
3. في إعدادات المستودع، اذهب إلى "Pages"
4. اختر الفرع الذي تريد نشره (عادة main أو master)
5. احفظ الإعدادات
6. بعد بضع دقائق، سيتم نشر موقعك على GitHub Pages

## استكشاف الأخطاء وإصلاحها

### مشكلة: فشل فتح نافذة تسجيل الدخول
- **الحل**: تأكد من السماح بالنوافذ المنبثقة في متصفحك

### مشكلة: بيانات المصادقة غير مكتملة
- **الحل**: تأكد من تكوين البوت بشكل صحيح في Telegram وإضافة النطاقات المسموح بها

### مشكلة: فشل إنشاء حساب في Firebase
- **الحل**: تحقق من إعدادات المصادقة في Firebase وتأكد من تفعيل مزود البريد الإلكتروني/كلمة المرور

### مشكلة: خطأ في الاتصال بالخادم
- **الحل**: تأكد من أن عنوان الخادم في طلب fetch صحيح

## ملاحظات أمنية

- في بيئة الإنتاج، يجب التحقق من صحة بيانات المصادقة من Telegram باستخدام hash
- لا تشارك توكن البوت مع أي شخص
- تأكد من إضافة جميع النطاقات التي سيتم استخدامها في قائمة النطاقات المسموح بها في Firebase
- تأكد من أن جميع البيانات الحساسة يتم تشفيرها عند نقلها
